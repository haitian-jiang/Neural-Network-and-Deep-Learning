# python main.py --dataset oraclefs1 --epochs 0 --manifold-mixup 100 --batch-fs 1 \
--rotations --cosine --gamma 0.8 --milestones 20 --batch-size 128 --preprocessing PEME \
--n-shots 1 --n-runs 1 --n-queries 19 --deterministic --seed 1 --n-ways 200 \
--save-model "model/oracle1.pt" --save-features "feat/oracle1.1.ft"
Using pytorch version: 1.11.0
Importing local files: args, utils, datasets, eval_few_shot, models.
Dataset contains 200 base classes, 200 val classes and 200 novel classes.
Generating runs... done.
Namespace(batch_size=128, batch_fs=1, feature_maps=64, lr=0.1, epochs=0, milestones=[20, 40, 60, 80], gamma=0.8, cosine=True, mixup=False, mm=False, label_smoothing=0, dropout=0, rotations=True, model='ResNet18', preprocessing='PEME', postprocessing='', manifold_mixup=100, temperature=1.0, ema=0, device='cuda:0', dataset_path='/remote-home/jianghaitian/NNDLfinal/oracle_fs/img/oracle_200_1_shot_strokes/train/', dataset_device='cuda:0', deterministic=True, skip_epochs=0, runs=1, quiet=False, dataset='oraclefs1', dataset_size=-1, output='', save_features='feat/oracle1.1.ft', save_model='model/oracle1.pt', test_features='', load_model='', seed=1, wandb='', n_shots=[1], n_runs=1, n_ways=200, n_queries=19, sample_aug=1, ncm_loss=False, episodic=False, episodes_per_epoch=100, transductive=False, transductive_softkmeans=False, transductive_n_iter=50, transductive_n_iter_sinkhorn=200, transductive_temperature=14, transductive_temperature_softkmeans=20, transductive_alpha=0.84, transductive_cosine=False, devices=[0])
Number of trainable parameters in model is: 11273484
   1 loss: 3.49254 ...val-1: 9.00%, nov-1: 7.84% (7.84%)
   2 loss: 2.48273 ...val-1: 13.71%, nov-1: 13.58% (13.58%)
   3 loss: 1.98140 ...val-1: 21.32%, nov-1: 21.47% (21.47%)
   4 loss: 1.28967 ...val-1: 25.50%, nov-1: 25.37% (25.37%)
   5 loss: 0.83439 ...val-1: 28.71%, nov-1: 30.32% (30.32%)
   6 loss: 0.54475 ...val-1: 31.82%, nov-1: 30.79% (30.79%)
   7 loss: 0.30994 ...val-1: 33.58%, nov-1: 32.89% (32.89%)
   8 loss: 0.23805 ...val-1: 35.66%, nov-1: 34.61% (34.61%)
   9 loss: 0.18715 ...val-1: 35.82%, nov-1: 34.18% (34.18%)
  10 loss: 0.13464 ...val-1: 34.29%, nov-1: 33.68% (34.18%)
  11 loss: 0.11157 ...val-1: 34.82%, nov-1: 34.26% (34.18%)
  12 loss: 0.10399 ...val-1: 36.74%, nov-1: 35.50% (35.50%)
  13 loss: 0.08775 ...val-1: 37.39%, nov-1: 36.16% (36.16%)
  14 loss: 0.06396 ...val-1: 36.97%, nov-1: 36.05% (36.16%)
  15 loss: 0.05942 ...val-1: 37.29%, nov-1: 36.03% (36.16%)
  16 loss: 0.05419 ...val-1: 37.50%, nov-1: 36.68% (36.68%)
  17 loss: 0.05077 ...val-1: 37.53%, nov-1: 37.53% (37.53%)
  18 loss: 0.03979 ...val-1: 38.16%, nov-1: 37.50% (37.50%)
  19 loss: 0.04544 ...val-1: 37.87%, nov-1: 36.76% (37.50%)
  20 loss: 0.04005 ...val-1: 37.82%, nov-1: 37.03% (37.50%)
  21 loss: 0.12497 ...val-1: 36.61%, nov-1: 35.16% (37.50%)
  22 loss: 0.10166 ...val-1: 36.42%, nov-1: 35.71% (37.50%)
  23 loss: 0.09628 ...val-1: 33.76%, nov-1: 34.29% (37.50%)
  24 loss: 0.08969 ...val-1: 36.18%, nov-1: 37.29% (37.50%)
  25 loss: 0.08313 ...val-1: 36.68%, nov-1: 35.95% (37.50%)
  26 loss: 0.07766 ...val-1: 35.37%, nov-1: 34.87% (37.50%)
  27 loss: 0.06922 ...val-1: 36.42%, nov-1: 36.16% (37.50%)
  28 loss: 0.06732 ...val-1: 36.45%, nov-1: 37.08% (37.50%)
  29 loss: 0.04765 ...val-1: 34.58%, nov-1: 34.61% (37.50%)
  30 loss: 0.04735 ...val-1: 39.18%, nov-1: 37.89% (37.89%)
  31 loss: 0.03671 ...val-1: 38.74%, nov-1: 38.29% (37.89%)
  32 loss: 0.03426 ...val-1: 37.61%, nov-1: 37.34% (37.89%)
  33 loss: 0.03561 ...val-1: 36.71%, nov-1: 37.05% (37.89%)
  34 loss: 0.02542 ...val-1: 38.82%, nov-1: 38.68% (37.89%)
  35 loss: 0.02182 ...val-1: 38.71%, nov-1: 38.63% (37.89%)
  36 loss: 0.02011 ...val-1: 38.71%, nov-1: 38.66% (37.89%)
  37 loss: 0.01909 ...val-1: 39.39%, nov-1: 39.16% (39.16%)
  38 loss: 0.01849 ...val-1: 39.50%, nov-1: 39.13% (39.13%)
  39 loss: 0.01877 ...val-1: 39.42%, nov-1: 39.24% (39.13%)
  40 loss: 0.01874 ...val-1: 39.26%, nov-1: 39.29% (39.13%)
  41 loss: 0.05200 ...val-1: 38.63%, nov-1: 38.05% (39.13%)
  42 loss: 0.04932 ...val-1: 37.29%, nov-1: 37.42% (39.13%)
  43 loss: 0.05540 ...val-1: 36.50%, nov-1: 37.63% (39.13%)
  44 loss: 0.03991 ...val-1: 35.37%, nov-1: 34.58% (39.13%)
  45 loss: 0.04371 ...val-1: 38.11%, nov-1: 37.05% (39.13%)
  46 loss: 0.03843 ...val-1: 38.66%, nov-1: 37.18% (39.13%)
  47 loss: 0.03355 ...val-1: 37.08%, nov-1: 36.24% (39.13%)
  48 loss: 0.03282 ...val-1: 39.37%, nov-1: 37.08% (39.13%)
  49 loss: 0.02630 ...val-1: 39.76%, nov-1: 38.29% (38.29%)
  50 loss: 0.02806 ...val-1: 36.71%, nov-1: 37.05% (38.29%)
  51 loss: 0.02338 ...val-1: 38.87%, nov-1: 38.47% (38.29%)
  52 loss: 0.02244 ...val-1: 39.13%, nov-1: 38.74% (38.29%)
  53 loss: 0.01753 ...val-1: 39.68%, nov-1: 39.55% (38.29%)
  54 loss: 0.01811 ...val-1: 39.47%, nov-1: 38.92% (38.29%)
  55 loss: 0.01489 ...val-1: 40.66%, nov-1: 39.53% (39.53%)
  56 loss: 0.01418 ...val-1: 40.47%, nov-1: 40.05% (39.53%)
  57 loss: 0.01264 ...val-1: 41.00%, nov-1: 39.61% (39.61%)
  58 loss: 0.01234 ...val-1: 40.76%, nov-1: 39.42% (39.61%)
  59 loss: 0.01209 ...val-1: 40.58%, nov-1: 39.26% (39.61%)
  60 loss: 0.01181 ...val-1: 40.61%, nov-1: 39.24% (39.61%)
  61 loss: 0.04495 ...val-1: 35.26%, nov-1: 35.47% (39.61%)
  62 loss: 0.03924 ...val-1: 35.74%, nov-1: 36.08% (39.61%)
  63 loss: 0.03774 ...val-1: 38.50%, nov-1: 38.66% (39.61%)
  64 loss: 0.03078 ...val-1: 39.34%, nov-1: 39.16% (39.61%)
  65 loss: 0.03708 ...val-1: 38.00%, nov-1: 38.03% (39.61%)
  66 loss: 0.02394 ...val-1: 37.87%, nov-1: 38.11% (39.61%)
  67 loss: 0.01954 ...val-1: 39.37%, nov-1: 38.89% (39.61%)
  68 loss: 0.01978 ...val-1: 39.79%, nov-1: 38.32% (39.61%)
  69 loss: 0.02554 ...val-1: 38.42%, nov-1: 38.32% (39.61%)
  70 loss: 0.02229 ...val-1: 39.95%, nov-1: 38.87% (39.61%)
  71 loss: 0.02016 ...val-1: 40.29%, nov-1: 39.63% (39.61%)
  72 loss: 0.01597 ...val-1: 39.79%, nov-1: 40.05% (39.61%)
  73 loss: 0.01306 ...val-1: 39.84%, nov-1: 39.89% (39.61%)
  74 loss: 0.01164 ...val-1: 40.79%, nov-1: 39.50% (39.61%)
  75 loss: 0.01229 ...val-1: 40.29%, nov-1: 39.61% (39.61%)
  76 loss: 0.01181 ...val-1: 40.08%, nov-1: 39.26% (39.61%)
  77 loss: 0.01069 ...val-1: 40.42%, nov-1: 39.61% (39.61%)
  78 loss: 0.01062 ...val-1: 41.32%, nov-1: 40.05% (40.05%)
  79 loss: 0.00999 ...val-1: 41.03%, nov-1: 39.84% (40.05%)
  80 loss: 0.00966 ...val-1: 40.97%, nov-1: 39.68% (40.05%)
  81 loss: 0.02703 ...val-1: 37.61%, nov-1: 38.13% (40.05%)
  82 loss: 0.03222 ...val-1: 38.58%, nov-1: 37.97% (40.05%)
  83 loss: 0.03206 ...val-1: 37.55%, nov-1: 37.29% (40.05%)
  84 loss: 0.02562 ...val-1: 41.16%, nov-1: 39.32% (40.05%)
  85 loss: 0.01948 ...val-1: 39.97%, nov-1: 38.87% (40.05%)
  86 loss: 0.01567 ...val-1: 39.05%, nov-1: 39.84% (40.05%)
  87 loss: 0.01700 ...val-1: 38.87%, nov-1: 38.05% (40.05%)
  88 loss: 0.02053 ...val-1: 39.21%, nov-1: 39.37% (40.05%)
  89 loss: 0.01699 ...val-1: 39.45%, nov-1: 39.37% (40.05%)
  90 loss: 0.01694 ...val-1: 39.76%, nov-1: 39.05% (40.05%)
  91 loss: 0.01639 ...val-1: 39.79%, nov-1: 38.92% (40.05%)
  92 loss: 0.01310 ...val-1: 39.63%, nov-1: 38.92% (40.05%)
  93 loss: 0.01467 ...val-1: 40.63%, nov-1: 40.24% (40.05%)
  94 loss: 0.01137 ...val-1: 40.71%, nov-1: 40.50% (40.05%)
  95 loss: 0.00989 ...val-1: 41.34%, nov-1: 40.55% (40.55%)
  96 loss: 0.00933 ...val-1: 40.87%, nov-1: 40.21% (40.55%)
  97 loss: 0.00952 ...val-1: 40.63%, nov-1: 39.97% (40.55%)
  98 loss: 0.00896 ...val-1: 40.95%, nov-1: 40.45% (40.55%)
  99 loss: 0.00877 ...val-1: 41.03%, nov-1: 40.61% (40.55%)
 100 loss: 0.00854 ...val-1: 40.92%, nov-1: 40.63% (40.55%)
Run 1 / 1
1-shot 40.55 (Â± 0.00) (conf: [0.00, 100.00]) (worst: 40.55, best: 40.55)